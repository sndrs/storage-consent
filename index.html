<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<script type="module" src="localStorage.js"></script>
		<script type="module">
			import { storage } from 'https://cdn.jsdelivr.net/npm/@guardian/libs@14.0.0/+esm'

			/**
			 * none of these run, because they fail silently at
			 * https://github.com/guardian/csnx/blob/main/libs/%40guardian/libs/src/storage/storage.ts#L16
			 *
			 * we should add a permitted key and also log something useful to the console
			 * if libs fails
			 */
			storage.session.set('block-storage.session.set', 'invasive data')
			storage.local.set('block-storage.local.set', 'invasive data')
			storage.session.set('allow-setItem', 'permitted data')
			storage.local.set('allow-setItem', 'permitted data')

			/**
			 * using `setItem`
			 * https://developer.mozilla.org/en-US/docs/Web/API/Storage/setItem
			 */

			try {
				sessionStorage.setItem(
					'allow sessionStorage.setItem',
					'permitted data',
				)
			} catch (e) {
				console.error(e)
			}

			try {
				localStorage.setItem(
					'allow localStorage.setItem',
					'permitted data',
				)
			} catch (e) {
				console.error(e)
			}

			try {
				sessionStorage.setItem(
					'block sessionStorage.setItem',
					'invasive data',
				)
			} catch (e) {
				console.error(e)
			}

			try {
				localStorage.setItem(
					'block localStorage.setItem',
					'invasive data',
				)
			} catch (e) {
				console.error(e)
			}

			/**
			 * using local/sessionStorage assignment
			 */

			try {
				sessionStorage['allow sessionStorage assignment'] =
					'permitted data'
			} catch (e) {
				console.error(e)
			}

			try {
				localStorage['allow localStorage assignment'] = 'permitted data'
			} catch (e) {
				console.error(e)
			}

			try {
				sessionStorage['block sessionStorage assignment'] =
					'invasive data'
			} catch (e) {
				console.error(e)
			}

			try {
				localStorage['block localStorage assignment'] = 'invasive data'
			} catch (e) {
				console.error(e)
			}
		</script>
		<title>Document</title>
	</head>
	<body>
		the infoâ€™s in the console...
	</body>
</html>
