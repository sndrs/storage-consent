<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<script type="module">
			import { regulatedStorage } from './src/regulatedStorage.js'

			try {
				const allowedKeys = ['allowed']

				console.group('Allowed storage keys:')
				allowedKeys.forEach((key) => console.log(`'${key}'`))
				console.groupEnd()

				for (const storageType of ['localStorage', 'sessionStorage']) {
					Object.defineProperty(window, storageType, {
						value: regulatedStorage({
							storageType,
							allowedKeys,
							debug: true,
						}),
					})
				}
			} catch (e) {
				// we need to use a proxy for this, so if it's not supported, we can't do anything
				console.error(e)
			}

			try {
				sessionStorage.setItem('allowed', 'good data')
			} catch (e) {
				console.error(e)
			}

			try {
				localStorage.setItem('not-allowed', 'evil data')
			} catch (e) {
				console.error(e)
			}
		</script>
	</head>
	<body>
		the infoâ€™s in the console...
	</body>
</html>
